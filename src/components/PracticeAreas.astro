---
import ContentCard from "./ui-kit/ContentCard.astro";
import ContentHeader from "./ui-kit/ContentHeader.astro";

const practiceAreas = [
  {
    label: "Défense des consommateurs",
    title: "Contentieux des panneaux photovoltaïques",
    description:
      "Une expertise reconnue dans la nullité des contrats de vente et de crédit liés aux installations photovoltaïques.",
    keywords: ["consentement", "crédit affecté", "jurisprudence protectrice"],
    href: "/domaines/contentieux-photovoltaique",
    linkText: "Accéder au contentieux",
    image: "/photovoltaiques.webp",
  },
  {
    label: "Procédure d'appel",
    title: "Postulation en appel",
    subtitle: "Cour d'appel de Douai",
    description:
      "Maîtrise rigoureuse des délais et de la procédure Magendie pour sécuriser vos dossiers en appel.",
    href: "/domaines/postulation-appel",
    linkText: "Voir la postulation",
    image: "/postulation_appel.webp",
  },
  {
    label: "Outil procédural",
    title: "Convention de procédure participative",
    description:
      "Un outil stratégique pour maîtriser le temps judiciaire et sécuriser le cadre procédural.",
    keywords: [
      "mise en état",
      "calendrier sécurisé",
      "interruption des délais",
    ],
    href: "/domaines/procedure-participative",
    linkText: "Comprendre l'outil",
    image: "/procedure_participative.webp",
  },
];
---

<section id="domaines" class="practice-areas">
  <div class="container">
    <ContentHeader
      eyebrow="Nos domaines"
      title="Expertise"
      description="Trois domaines d'intervention où nous mettons notre expertise juridique au service de vos intérêts."
    />

    <div class="cards-grid">
      {
        practiceAreas.map((area) => (
          <ContentCard
            label={area.label}
            title={area.title}
            subtitle={area.subtitle}
            description={area.description}
            keywords={area.keywords}
            href={area.href}
            linkText={area.linkText}
            image={area.image}
            class="card"
          />
        ))
      }
    </div>
  </div>
</section>

<style>
  .practice-areas {
    position: relative;
    z-index: 10;
    background-color: var(--color-bg);
    display: flex;
    align-items: center;
    padding: 128px 24px;
    overflow: hidden;
  }

  .container {
    width: 100%;
    max-width: 1440px;
    margin: 0 auto;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 6rem;
  }

  .cards-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 32px;
    width: 100%;
  }

  @media (max-width: 768px) {
    .practice-areas {
      padding: 64px 16px;
    }

    .container {
      gap: 4rem;
    }
  }

  @media (max-width: 1024px) {
    .cards-grid {
      grid-template-columns: 1fr;
      gap: 24px;
    }
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const section = document.querySelector(".practice-areas");
  const grid = section?.querySelector(".cards-grid");
  const cards = section?.querySelectorAll(".card");

  // Staggered y offsets for 3 cards
  const offsets = [48, 96, 144];

  if (grid && cards) {
    cards.forEach((card, index) => {
      const yOffset = offsets[index] || 64;

      gsap.fromTo(
        card,
        {
          y: yOffset,
        },
        {
          y: 0,
          ease: "none",
          scrollTrigger: {
            trigger: grid,
            start: "top 95%",
            end: "top 30%",
            scrub: true,
          },
        },
      );
    });
  }
</script>
