---
import Button from "./ui-kit/Button.astro";
import ContentHeader from "./ui-kit/ContentHeader.astro";
import { ArrowUpRight } from "lucide-astro";
---

<section id="cabinet-preview" class="cabinet-preview">
  <div class="background-decor"></div>

  <div class="container">
    <div class="grid-layout">
      <!-- Content Column (Left) -->
      <div class="text-col">
        <div class="content-wrapper">
          <ContentHeader
            eyebrow="Le Cabinet"
            title="Rigueur juridique &"
            titleSecondLine="Stratégie procédurale"
            description={[
              '<strong class="text-primary">VINDEX</strong> incarne une vision exigeante de la profession d\'avocat. Implanté à Douai, notre cabinet est une référence en matière de <span class="highlight">défense des consommateurs</span> et de maîtrise des procédures d\'appel.',
              "Nous croyons que la technicité du droit ne doit jamais obscurcir la clarté de la stratégie. Chaque dossier est traité avec une précision chirurgicale, veillant au respect scrupuleux des formes et des délais qui font la force d'une défense inébranlable.",
            ]}
          />

          <div class="actions">
            <Button href="/cabinet" variant="primary" class="custom-btn">
              Découvrir notre vision
              <ArrowUpRight class="btn-icon" width={18} height={18} />
            </Button>
          </div>
        </div>
      </div>

      <!-- Visual Column (Right) -->
      <div class="visual-col">
        <div class="image-wrapper">
          <img
            src="/demo-photo.avif"
            alt="Cabinet VINDEX - Bureau et expertise juridique"
            class="cabinet-image"
          />
          <div class="overlay-card blur-background">
            <span class="stat-number">20+</span>
            <span class="stat-label">Années d'expérience cumulée</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .cabinet-preview {
    position: relative;
    padding: 160px 0;
    height: 100vh;
    display: flex;
    align-items: center;
    background-color: #fafafa;
    overflow: hidden;
  }

  .background-decor {
    position: absolute;
    top: -20%;
    right: -10%;
    width: 60vw;
    height: 60vw;
    background: radial-gradient(
      circle,
      rgba(var(--color-primary-rgb), 0.05) 0%,
      transparent 70%
    );
    pointer-events: none;
    z-index: 0;
  }

  .container {
    width: 100%;
    max-width: 1392px;
    margin: 0 auto;
    z-index: 1;
  }

  .grid-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 80px;
    align-items: center;
  }

  /* Visual Column Styles */
  .visual-col {
    position: relative;
  }

  .image-wrapper {
    position: relative;
    width: 100%;
    height: 720px;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.05);
  }

  .cabinet-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .overlay-card {
    position: absolute;
    bottom: 40px;
    right: -30px;
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.9);
    padding: 30px;
    width: 200px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .stat-number {
    font-family: var(--font-heading);
    font-size: 3rem;
    line-height: 1;
    color: var(--color-primary);
  }

  .stat-label {
    font-family: var(--font-sans);
    font-size: 0.85rem;
    color: var(--color-text-main);
    line-height: 1.4;
  }

  /* Text Column Styles */
  .text-col {
    padding-right: 20px;
  }

  .content-wrapper {
    max-width: 560px;
  }

  /* Utility classes for description HTML */
  .text-primary {
    color: var(--color-primary);
    font-weight: 500;
  }

  .highlight {
    background: linear-gradient(
      to right,
      rgba(var(--color-primary-rgb), 0.15) 0%,
      transparent 100%
    );
    padding: 0 4px;
    border-radius: 2px;
  }

  .actions {
    margin-top: 40px;
  }

  .custom-btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .btn-icon {
    transition: transform 0.3s ease;
  }

  .custom-btn:hover .btn-icon {
    transform: translate(2px, -2px);
  }

  @media (max-width: 1024px) {
    .cabinet-preview {
      padding: 100px 0;
    }

    .grid-layout {
      grid-template-columns: 1fr;
      gap: 60px;
    }

    .text-col {
      padding-right: 0;
      order: 1;
    }

    .visual-col {
      order: 2;
    }

    .image-wrapper {
      height: 500px;
      width: 100%;
    }

    .overlay-card {
      right: 0;
      bottom: -20px;
    }
  }
</style>

<script>
  import gsap from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  const section = document.querySelector(".cabinet-preview");
  const image = section?.querySelector(".cabinet-image");
  const overlay = section?.querySelector(".overlay-card");

  if (section && image) {
    // Parallax Effect for Image only
    gsap.to(image, {
      y: 80,
      scale: 1.08,
      scrollTrigger: {
        trigger: section,
        start: "top bottom",
        end: "bottom top",
        scrub: 1.5,
      },
    });
  }
</script>
